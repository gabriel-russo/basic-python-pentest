#!/usr/bin/env python3

from requests import get, ConnectionError
from sys import argv
from re import match

if argv[1] is None:
    raise Exception('Provide a Domain name!')

wordlist = '/usr/share/wordlists/seclists/Discovery/Web-Content/common.txt'

# Seclist Wordlist
with open(wordlist, 'r') as arq:
    directories = arq.read().splitlines()
    for dir in directories:
        if not match(r'^#|^\s*$', dir): # Not begin with # or empty lines
            url = f"http://{argv[1]}/{dir}"
            r = get(url)
            if r.status_code == 404:
                pass
            else:
                print(f"Valid directory: {url}")
