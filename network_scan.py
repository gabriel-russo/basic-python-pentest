#!/usr/bin/env python3

from scapy.all import srp, Ether, ARP

interface = "enp1s0"
ip_range = "10.10.X.X/24"
broadcast_MAC = "ff:ff:ff:ff:ff:ff" 

# Stacked layers
## link: https://scapy.readthedocs.io/en/latest/usage.html#stacking-layers
# Ether
## link: https://scapy.readthedocs.io/en/latest/api/scapy.layers.l2.html?highlight=ETHER#scapy.layers.l2.Ether
# ARP
## link: https://scapy.readthedocs.io/en/latest/api/scapy.layers.l2.html?highlight=ETHER#scapy.layers.l2.ARP
packet = Ether(dst=broadcast_MAC)/ARP(pdst=ip_range)

# Both are layer 2, so ...
# srp -> send and receive packates at layer 2
## link: https://scapy.readthedocs.io/en/latest/api/scapy.sendrecv.html?highlight=srp#scapy.sendrecv.srp
answered, not_answered = srp(packet, timeout=2, iface=interface, inter=0.1)

for send, receive in answered:
    print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))
